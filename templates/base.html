<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Vé Nhanh – Trải Nghiệm Điện Ảnh Đỉnh Cao{% endblock %}</title>

    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    {% block extra_css %}{% endblock %}

    <style>
        :root { --main-red: #dc3545; --dark-bg: #0f0f0f; }
        body { font-family: 'Lexend', sans-serif; background-color: #f4f4f4; }
        .cinema-navbar { background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); }
        .brand-red { color: var(--main-red); letter-spacing: 1px; }
        
        /* Hero Slider Fade Effect */
        .hero-slider { position: relative; height: 500px; overflow: hidden; background: #000; }
        .hero-slide { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            opacity: 0; transition: opacity 1s ease-in-out; 
        }
        .hero-slide.active { opacity: 1; }
        .hero-slide img { width: 100%; height: 100%; object-fit: cover; }
        
        .dropdown-menu { border: none; border-radius: 12px; }
        .cinema-footer { background: #1a1a1a; color: white; padding: 60px 0 30px; }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark sticky-top cinema-navbar shadow-sm">
    <div class="container">
        <a class="navbar-brand d-flex align-items-center fw-bold" href="{{ url_for('index') }}">
            <img src="{{ url_for('static', filename='images/logo.png') }}" height="38" class="me-2" 
                 onerror="this.src='https://via.placeholder.com/38x38?text=VN'">
            <span class="brand-red">VÉ NHANH</span>
        </a>

        <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link px-3 {% if request.endpoint == 'index' %}active text-danger{% endif %}" 
                       href="{{ url_for('index') }}">Lịch chiếu</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link px-3 {% if request.endpoint == 'rap_phim' %}active text-danger{% endif %}" 
                       href="{{ url_for('rap_phim') }}">Rạp phim</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link px-3 {% if request.endpoint == 'khuyen_mai' %}active text-danger{% endif %}" 
                       href="{{ url_for('khuyen_mai') }}">Khuyến mãi</a>
                </li>
            </ul>

            <div class="d-flex align-items-center gap-2">
                {% if session.get('user') %}
                    {% if session.get('role') == 'admin' %}
                    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-warning btn-sm rounded-pill px-3 fw-bold me-2">
                        <i class="fas fa-user-shield me-1"></i> Quản trị
                    </a>
                    {% endif %}

                    <div class="dropdown">
                        <a class="btn btn-outline-light btn-sm rounded-pill px-3 dropdown-toggle d-flex align-items-center" 
                           href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle fs-5 me-2"></i> {{ session['user'] }}
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end shadow-lg mt-2 p-2 anim-fade-in">
                            <li>
                                <a class="dropdown-item rounded-2 py-2" href="{{ url_for('my_tickets') }}">
                                    <i class="fas fa-ticket-alt me-2 text-danger"></i> Vé của tôi
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item rounded-2 py-2 text-danger" href="{{ url_for('logout') }}">
                                    <i class="fas fa-sign-out-alt me-2"></i> Đăng xuất
                                </a>
                            </li>
                        </ul>
                    </div>
                {% else %}
                    <a href="{{ url_for('login') }}" class="btn btn-link text-white text-decoration-none px-3">Đăng nhập</a>
                    <a href="{{ url_for('register') }}" class="btn btn-danger btn-sm rounded-pill px-4 shadow-sm">Đăng ký</a>
                {% endif %}
            </div>
        </div>
    </div>
</nav>

{% if request.endpoint == 'index' %}
<section class="hero-slider">
    {% for i in range(1, 6) %}
    <div class="hero-slide {% if loop.first %}active{% endif %}">
        <img src="{{ url_for('static', filename='images/banner' ~ i ~ '.jpg') }}" 
             alt="Banner {{ i }}"
             onerror="this.src='https://via.placeholder.com/1920x600?text=Phim+Hot+Tháng+01'">
    </div>
    {% endfor %}
</section>
{% endif %}

<main class="container py-4 min-vh-100">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-{{ category if category != 'message' else 'warning' }} alert-dismissible fade show rounded-pill px-4 shadow-sm" role="alert">
            <i class="fas fa-info-circle me-2"></i> {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
</main>

<footer class="cinema-footer">
    <div class="container">
        <div class="row gy-4">
            <div class="col-lg-5">
                <h5 class="fw-bold mb-4 brand-red">VỀ VÉ NHANH</h5>
                <p class="text-white-50 lh-lg">
                    Đồ án môn học hướng đến cung cấp giải pháp đặt tất cả vé trên một ứng dụng nhanh chóng, tiện lợi. 
                    Mong muốn tối ưu hóa lựa chọn và trải nghiệm người dùng.
                </p>
            </div>
            <div class="col-lg-3 col-md-6">
                <h6 class="text-uppercase fw-bold mb-4">Thông tin</h6>
                <ul class="list-unstyled">
                    <li class="mb-2"><a href="#" class="text-white-50 text-decoration-none">Giới thiệu</a></li>
                    <li class="mb-2"><a href="#" class="text-white-50 text-decoration-none">Chính sách bảo mật</a></li>
                    <li class="mb-2"><a href="#" class="text-white-50 text-decoration-none">Điều khoản sử dụng</a></li>
                </ul>
            </div>
            <div class="col-lg-4 col-md-6 text-md-end">
                <h6 class="text-uppercase fw-bold mb-4">Kết nối với chúng tôi</h6>
                <div class="d-flex gap-3 justify-content-md-end">
                    <a href="#" class="btn btn-outline-light btn-sm rounded-circle"><i class="fab fa-facebook-f p-1"></i></a>
                    <a href="#" class="btn btn-outline-light btn-sm rounded-circle"><i class="fab fa-youtube p-1"></i></a>
                    <a href="#" class="btn btn-outline-light btn-sm rounded-circle"><i class="fab fa-instagram p-1"></i></a>
                </div>
            </div>
        </div>
        <hr class="border-secondary my-5">
        <div class="text-center text-white-50 small">
            &copy; 2026 <strong>Vé Nhanh</strong>. Tất cả vé bạn cần.
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Logic Slider Banner mượt mà
    document.addEventListener('DOMContentLoaded', function() {
        const slides = document.querySelectorAll('.hero-slide');
        if (slides.length > 0) {
            let currentSlide = 0;
            setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
            }, 5000); // Chuyển slide sau 5 giây
        }
    });
</script>

</body>
</html>